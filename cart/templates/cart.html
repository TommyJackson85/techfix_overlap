{% extends 'base.html' %}
{% load static from staticfiles %}
{% load bootstrap_tags %}

{% block page_heading %}
<div class="container">
    <h1>Feature Votes Cart:</h1>
    <p>Remember that for each 10 Euro donated by all users counts as 1 vote for the Feature Request. i.e 52 Euro counts as 5 votes only but if a user adds 18 euro it adds to 7 votes.</p>
</div>
{% endblock page_heading %} 

{% block content %}
<div class="row row-flex">
    {% for item in cart_items %}
    <div class="col-md-3 col-sm-6 col-xs-12">
        <div class="panel panel_cart_item">
            <div class="panel-heading panel_post_head">
                <h3>
                <strong>
                {% if item.feature_voted.title|length >= 20 %}
                    {{ item.feature_voted.title|slice:":18" }}..
                {% else %}
                    {{ item.feature_voted.title }}
                {% endif %}
                </strong>
                </h3>
                <p>Collective user donations:</p> 
                <p><em>
                 
                {% if item.feature_voted.votes_cost == 0 %} 
                    <strong class="dark_red_text">{{ item.feature_voted.votes_cost}} €</strong>
                {% else %}
                    <strong class="dark_green_text">{{ item.feature_voted.votes_cost}} €</strong>
                {% endif %}
                <!--label starts-->
                {% if item.feature_voted.votes == 0 %}
                    <label class="badge badge-negative">
                {% else %}
                    <label class="badge badge-positive">
                {% endif %}
                    {{ item.feature_voted.votes }} Votes so far!
                    <!--label ends-->
                    </label>
                </p></em>
            </div>
            <div class="panel-body">
                <p><strong class="dark_green_text">You will add:</strong></p>
                <p>
                    <form class="form-inline" method="post" action="{% url 'adjust_cart' item.id %}">
                        {% csrf_token %}
                        <div class="form-group">
                            <label for="exampleInputAmount" class="sr-only">Adjust your offer</label>
                            <div class="input-group">
                                <div class="input-group-addon">Euro</div>
                                <input name="quantity" type="number" min="0" max="999" class="form-control">
                                <div class="input-group-addon">{{ item.money_amount }} €</div>
                            </div>
                        </div>
                        <button type="submit" class="btn purchase_ammend_button"><span class="glyphicon glyphicon-edit" aria-hidden="true"></span>Amend</button>
                    </form>
                </p>
            </div>
        </div>
    </div>
    {% endfor %}
</div>
<div class="row text-center">
    <strong class="dark_green_text">
        <p>Total Cost</p>
        <p><span class="glyphicon glyphicon-euro" aria-hidden="true"></span>{{ total_cost }} €</p>
    </strong>
    {% if user.is_authenticated %}
        {% if total_cost > 0 %}
        <a href="{% url 'checkout' %}" class="btn purchase_button" role="button"><span class="glyphicon glyphicon-ok-sign" aria-hidden="true"></span>Checkout</a>
        {% endif %}
    {% else %}
        <a type="button" class="btn login_button" href="{% url 'login' %}">Login To Purchase Feature Votes</a>
        <p class="red_text">Don't have an account?</p>
        <a type="button" class="btn registration_button" href="{% url 'registration' %}">Register Account</a>
    {% endif %}
</div>

{% endblock %}